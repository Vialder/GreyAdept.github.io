---
import Layout from '../layouts/Layout.astro';
import Card from '../components/Card.astro';
import '@fontsource/notable';
import '@fontsource-variable/hepta-slab';
let imgScale = 1;

import 'swiper/css';
import 'swiper/css/navigation';
import 'swiper/css/pagination';
import { Image } from 'astro:assets';



---

<Layout title="Antenna Roots">
	<!doctype html>
	<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta name="description" content="Antenna Roots" />
    <title>Image Gallery</title>
  </head>
  <body class="bg-gray-100">
    <div class="container mx-auto p-4">
		<br>
		<h1 id="title" class="font-extralight">Antenna Roots</h1>
		<br>
		<p>
			Tulossa...
		</p>
  </body>
  <div id="footer" class="container mx-auto p-4">
	<u><h1 id="takaisin" class="font-extralight"><a href="/">Alkuun</a></h1></u>
</div>	
</html>
</Layout>

<style define:vars={{ imgScale }}>

	body {
		/*display: flex;*/
		/*flex-direction: column;*/
		margin: 0px;
		padding: 0em;
		background-color: white;
		overflow: hidden;
		min-height: 100svh;
	}
	
	h1 {
		line-height: normal;
		color: black;	
		text-align: center;
		font-family: 'Hepta Slab Variable', serif;	
		margin-bottom: 5px;
		margin-top: 5px;
	}

	h2 {
		font-family: 'Hepta Slab Variable', serif;	
		text-align: center;
	}
	.animation
	{
		position: relative;
	}

	
	

	#footer {
		position:fixed;
		bottom: 0;
		text-align: center;
		padding-top: 1%;
		z-index: 10;
	}


    .gallery_img {
		width: 100%;
      	height: 100%;
		transform: scale(0.8);
		display: block;
		margin: auto;
		transition: all 10s ease-in-out;
		cursor: pointer;
		opacity: 0.5;
		object-fit: scale-down;
		
    }
    
	
	.swiper {
	    width: 99%;
  		height: 60vh;
		display: flex;
		padding-bottom: 1px;

	}

	.swiper-slide
	{
		
	}

	.swiper-pagination{
		
	}


    #buttonsandbars {
		gap: 3px;
		margin-top: 3px;
		display: flex;
		margin-left: auto;
		margin-right: auto;
		justify-content: center;
    }
	
	.swiper-button-prev {
		color: black;
	}
	.swiper-button-next {
		color: black;
	}

	.swiper-slide
	{
		transition: all 1s;  
	}

	#playbutton{
		visibility: visible;
	}
	
	#pausebutton{
		visibility: hidden;
	}

	.controlbutton{
		display: block;
		opacity: 0.5;
		cursor:pointer;
		transition: opacity 0.5s ease-in-out;
	}

	.controlbutton:hover {
		opacity: 1;
	}

	.controlbutton:active {
		opacity: 1;
	}

	h1{
		font-size: 1.2rem;
	}

	@media (min-width: 992px) {
		h1 {
			font-size: 2rem;
		}
	}

.playing {
  position: absolute;
  display: block;
  margin-top: 25px;
}
.now.playing .bar {
  display: inline-block;
  margin-right: 1px;
  width: 2px;
  height: 1px;
  overflow: hidden;
  background: grey;
  color: transparent;
  animation-name: pulse;
  animation-duration: 1s;
  animation-iteration-count: 0;
 
  
  
}

.paused.playing .bar {
  animation-iteration-count: infinite;
}



.n1 {
  animation-delay: 0.6s;
}
.n2 {
  animation-delay: 0.3s;
}
.n3 {
  animation-delay: 1.4s;
}
.n4 {
  animation-delay: 1.0s;
}
.n5 {
  animation-delay: 2.4s;
}
.n6 {
  animation-delay: 1.4s;
}
.n7 {
  animation-delay: 3.2s;
}
.n8 {
  animation-delay: 2.0s;
}
@keyframes pulse {
  0% {
    height: 1px;
    margin-top: 0;
  }
  10% {
    height: 20px;
    margin-top: -20px;
  }
  50% {
    height: 10px;
    margin-top: -10px;
  }
  60% {
    height: 20px;
    margin-top: -20px;
  }
  80% {
    height: 30px;
    margin-top: -30px;
  }
  100% {
    height: 1px;
    margin-top: 0;
  }
}
</style>

<script>
	import Swiper from 'swiper';
	import { Navigation, Pagination, HashNavigation } from 'swiper/modules';
	
	const swiper = new Swiper('.swiper', {
	//swiper modules
	modules: [Navigation, Pagination, HashNavigation],
	// Optional parameters
	direction: 'horizontal',
	loop: true,
	autoHeight: false,
    speed: 600,
	spaceBetween: 40,
	hashNavigation: {
		watchState: true,
	},

	// If we need pagination
	pagination: {
	  el: '.swiper-pagination',
	  type: 'fraction',
	  clickable: true,
	},
  
	// Navigation arrows
	navigation: {
	  nextEl: '.swiper-button-next',
	  prevEl: '.swiper-button-prev',
	},
  	});

	

	var hasClicked = false;
	const button = document.querySelector("#Capa_1");

	const pauseButton = document.getElementById("pausebutton");
	const playButton = document.getElementById("playbutton");

	const pagi = document.getElementById("pagi")

	const allImages = Array.from(document.getElementsByClassName("gallery_img") as HTMLCollectionOf<HTMLElement>);
	const image1 = document.getElementById("img01");
	const image2 = document.getElementById("img02");
	const image3 = document.getElementById("img03");
	const image4 = document.getElementById("img04");
	const image5 = document.getElementById("img05");
	const image6 = document.getElementById("img06");
	const image7 = document.getElementById("img07");
	const image8 = document.getElementById("img08");
	const image9 = document.getElementById("img09");
	const image10 = document.getElementById("img10");

	const arrow1 = document.getElementById("arrow1");
	const arrow2 = document.getElementById("arrow2");
	

	const audio = document.createElement('audio'); audio.id = "audio";
	audio.src = "https://dl.dropbox.com/scl/fi/29mhuzz9phbi8cf7z4v1s/1-Sementin-leiju-masterv1.flac?rlkey=c96h0gfr71etux3ngvjh0n562&st=l4r8vp8y"

	const audio1 = 'https://media.tyhjyydenvalu.com/1%20Sementin%20leiju%20masterv1.flac';
	const audio2 = 'https://media.tyhjyydenvalu.com/2%20Inhimillisyyskato%20masterv1.flac';
	const audio3 = 'https://media.tyhjyydenvalu.com/3%20Kammio%20masterv1%20(1).flac';
	const audio4 = 'https://media.tyhjyydenvalu.com/4%20Ulosp%C3%A4%C3%A4syyn%20vie%20tie%20masterv1.flac';
	const audio5 = 'https://media.tyhjyydenvalu.com/5%20Muistitko%20edes%20valon%20masterv1.flac';
	const audio6 = 'https://media.tyhjyydenvalu.com/6%20Ja%20y%C3%B6%20oli%20hiljainen%20ja%20ter%C3%A4v%C3%A4%20masterv1.flac';
	const audio7 = 'https://media.tyhjyydenvalu.com/7%20Kulutettu%20loppuun%20masterv1.flac';
	const audio8 = 'https://media.tyhjyydenvalu.com/8%20L%C3%A4mmin%20valo%20masterv1.flac';
	const audio9 = 'https://media.tyhjyydenvalu.com/9%20Kipua%20n%C3%A4m%C3%A4%20masterv1.flac';
	const audio10 ='https://media.tyhjyydenvalu.com/10%20Sokkelon%20ydin%20masterv1.flac';
	

	//var audio = new Audio(optimizeUrl
	//audiosus.volume = 0;
	//var audio = new Audio('https://res.cloudinary.com/demo/video/upload/dog.mp3')

	var player = document.getElementById("music");
	
	
	//img1Obj.style.opacity = "0.5";


	function imageUp() {
		
		let selector = swiper.realIndex;
		switch(selector)
		{
			case 0:
				audio.src = audio1;
				break;
			
			case 1:
				audio.src = audio2;
				break;
			case 2:
				audio.src = audio3;
				break;
			
			case 3:
				audio.src = audio4;
				break;

			case 4:
				audio.src = audio5;
				break;
			
			case 5:
				audio.src = audio6;
				break;
			case 6:
				audio.src = audio7;
				break;
			
			case 7:
				audio.src = audio8;
				break;
			
			case 8:
				audio.src = audio9;
				break;
			
			case 9:
				audio.src = audio10;
				break;

			default:
				audio.src = audio1;
				break;	
		}
			
		
		togglePause();
		audio.volume = 0;
		fadeVolIn(0);
		for (let i = 0; i < allImages.length; i++) 
		{
  			allImages[i].style.transform = "scale(1.0)"
			allImages[i].style.opacity = "1"
		}
		pagi.style.visibility = "hidden";
		pauseButton.style.visibility = "visible";
		playButton.style.visibility = "hidden";
		arrow1.style.visibility = "hidden"
		arrow2.style.visibility = "hidden"
		console.log(audio.paused);
		player.style.visibility = "visible";
		player.classList.add("paused")
		//player.classList.toggle("paused");

	}

	function imageDown() {
		audio.volume = 1;
		fadeVolOut(1);
		hasClicked = false;
		for (let i = 0; i < allImages.length; i++) 
		{
  			allImages[i].style.transform = "scale(0.8)"
			allImages[i].style.opacity = "0.5"
		}
		pagi.style.visibility = "visible";
		pauseButton.style.visibility = "hidden";
		playButton.style.visibility = "visible";
		arrow1.style.visibility = "visible"
		arrow2.style.visibility = "visible"
		console.log(audio.paused);
		player.classList.remove("paused");
		//player.classList.toggle("paused");

	}

	function togglePause() {
		if (audio.paused) {
			audio.play();
			audio.onended = function(){
				pauseStop();
			}
		}
		else {
			audio.pause();
		}
	}

	function pauseStop() {
		fadeVolOut(1);
		for (let i = 0; i < allImages.length; i++) 
		{
  			allImages[i].style.transform = "scale(0.8)"
			allImages[i].style.opacity = "0.5"
		}
		pauseButton.style.visibility = "hidden";
		playButton.style.visibility = "visible";
		console.log(audio.paused);
		
		player.classList.remove("paused");
	}

	function changeSong() {
		if (!audio.paused)
	{
		audio.pause();
	}
	pauseButton.style.visibility = "hidden";
	playButton.style.visibility = "visible";
	let selector = swiper.realIndex;
		switch(selector)
		{
			case 0:
				audio.src = audio1;
				break;
			
			case 1:
				audio.src = audio2;
				break;
			case 2:
				audio.src = audio3;
				break;
			
			case 3:
				audio.src = audio4;
				break;

			case 4:
				audio.src = audio5;
				break;
			
			case 5:
				audio.src = audio6;
				break;
			case 6:
				audio.src = audio7;
				break;
			
			case 7:
				audio.src = audio8;
				break;
			
			case 8:
				audio.src = audio9;
				break;
			
			case 9:
				audio.src = audio10;
				break;

			default:
				audio.src = audio1;
				break;	
		}
		if (hasClicked)
		{
			imageUp();
		}
		
		
	}

	function fadeVolIn(newPercent){
		console.log("fading in!")
		if(newPercent < 1){
		audio.volume = newPercent;
		setTimeout(fadeVolIn,2, newPercent+0.001);
		}
		else{
			audio.volume = 1;
		}
	}
	function fadeVolOut(newPercent){
		console.log("fading out!")
		if(newPercent > 0){
		audio.volume = newPercent;
		setTimeout(fadeVolOut,2, newPercent-0.001);
		}
		else{
			audio.volume = 0;
		}
	}

	

	/*
	function volumeUp() {
		if (audio.volume < 0.9) {
			audio.volume += 0.1;
			setTimeout(volumeUp,100);
		} else {
			audio.volume = 1;
		}
		}
	
	function volumeDown() {
		if (audio.volume > 0.1) {
			audio.volume -= 0.1;
			setTimeout(volumeDown,100);
		} 
		else{
			audio.volume = 0;
			togglePause();
		}	
	}
	*/


    image1.addEventListener('click', () => {
		console.log("it works");
		hasClicked = true;
		if (document.getElementById("pausebutton").style.visibility == "visible") {
			imageDown();
		} else {
			imageUp()	
		}

	});
	image2.addEventListener('click', () => {
		console.log("it works");
		hasClicked = true;
		if (document.getElementById("pausebutton").style.visibility == "visible") {
			imageDown();
		} else {
			imageUp()	
		}

	});
	image3.addEventListener('click', () => {
		console.log("it works");
		hasClicked = true;
		if (document.getElementById("pausebutton").style.visibility == "visible") {
			imageDown();
		} else {
			imageUp()	
		}

	});
	image4.addEventListener('click', () => {
		console.log("it works");
		hasClicked = true;
		if (document.getElementById("pausebutton").style.visibility == "visible") {
			imageDown();
		} else {
			imageUp()	
		}

	});
	image5.addEventListener('click', () => {
		console.log("it works");
		hasClicked = true;
		if (document.getElementById("pausebutton").style.visibility == "visible") {
			imageDown();
		} else {
			imageUp()	
		}

	});
	image6.addEventListener('click', () => {
		console.log("it works");
		hasClicked = true;
		if (document.getElementById("pausebutton").style.visibility == "visible") {
			imageDown();
		} else {
			imageUp()	
		}

	});
	image7.addEventListener('click', () => {
		console.log("it works");
		hasClicked = true;
		if (document.getElementById("pausebutton").style.visibility == "visible") {
			imageDown();
		} else {
			imageUp()	
		}

	});
	image8.addEventListener('click', () => {
		console.log("it works");
		hasClicked = true;
		if (document.getElementById("pausebutton").style.visibility == "visible") {
			imageDown();
		} else {
			imageUp()	
		}

	});
	image9.addEventListener('click', () => {
		console.log("it works");
		hasClicked = true;
		if (document.getElementById("pausebutton").style.visibility == "visible") {
			imageDown();
		} else {
			imageUp()	
		}

	});
	image10.addEventListener('click', () => {
		console.log("it works");
		hasClicked = true;
		if (document.getElementById("pausebutton").style.visibility == "visible") {
			imageDown();
		} else {
			imageUp()	
		}

	});
	
    button.addEventListener('click', () => {
		console.log("it works");
		hasClicked = true;
		if (document.getElementById("pausebutton").style.visibility == "visible") {
			imageDown();
		} else {
			imageUp();
		}
	
	});
	
	window.onhashchange = changeSong;
	
	
</script>

